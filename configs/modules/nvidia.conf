# NVIDIA kernel module configuration
# Optimized for hybrid GPU setups with power management

# Enable DRM kernel mode setting
options nvidia-drm modeset=1

# NVIDIA power management configuration
# NVreg_DynamicPowerManagement=0x02: Enable dynamic power management
options nvidia NVreg_DynamicPowerManagement=0x02

# Enable GPU firmware loading for better power management
options nvidia NVreg_EnableGpuFirmware=1

# Preserve video memory allocations during suspend
options nvidia NVreg_PreserveVideoMemoryAllocations=1

# Enable runtime power management
options nvidia NVreg_EnableS0ixPowerManagement=1

# Disable GSP firmware for compatibility (can be enabled on newer GPUs)
options nvidia NVreg_EnableGpuFirmware=0

# Memory allocation strategy for better performance
options nvidia NVreg_MemoryPoolSize=1073741824

# Blacklist nouveau to prevent conflicts
blacklist nouveau
blacklist lbm-nouveau
alias nouveau off
alias lbm-nouveau off